{"version":3,"sources":["../../../src/clients/bot/sign-in.ts"],"names":["apiClientSettings","Client","mergeApiClientSettings","qs"],"mappings":";;;;;;;;;;AAOO,MAAM,oBAAuB,GAAA;AAAA,EAClC,GAAK,EAAA,4BAAA;AAAA,EACL,QAAU,EAAA;AACZ;AAgBO,MAAM,eAAgB,CAAA;AAAA,EAC3B,IAAI,IAAO,GAAA;AACT,IAAA,OAAO,IAAK,CAAA,KAAA;AAAA;AACd,EACA,IAAI,KAAK,CAAG,EAAA;AACV,IAAA,IAAA,CAAK,KAAQ,GAAA,CAAA;AAAA;AACf,EACU,KAAA;AAAA,EACA,kBAAA;AAAA,EAEV,WAAA,CAAY,SAAkCA,mBAAgD,EAAA;AAC5F,IAAA,IAAI,CAAC,OAAS,EAAA;AACZ,MAAK,IAAA,CAAA,KAAA,GAAQ,IAAIC,WAAO,EAAA;AAAA,KAC1B,MAAA,IAAW,aAAa,OAAS,EAAA;AAC/B,MAAA,IAAA,CAAK,KAAQ,GAAA,OAAA;AAAA,KACR,MAAA;AACL,MAAK,IAAA,CAAA,KAAA,GAAQ,IAAIA,WAAA,CAAO,OAAO,CAAA;AAAA;AAEjC,IAAK,IAAA,CAAA,kBAAA,GAAqBC,yCAAuBF,mBAAiB,CAAA;AAAA;AACpE,EAEA,MAAM,OAAO,MAA+B,EAAA;AAC1C,IAAM,MAAA,CAAA,GAAIG,mBAAG,CAAA,SAAA,CAAU,MAAM,CAAA;AAC7B,IAAM,MAAA,GAAA,GAAM,MAAM,IAAA,CAAK,IAAK,CAAA,GAAA;AAAA,MAC1B,CAAA,EAAG,KAAK,kBAAmB,CAAA,QAAQ,IAAI,oBAAqB,CAAA,GAAG,IAAI,CAAC,CAAA;AAAA,KACtE;AAEA,IAAA,OAAO,GAAI,CAAA,IAAA;AAAA;AACb,EAEA,MAAM,YAAY,MAAoC,EAAA;AACpD,IAAM,MAAA,CAAA,GAAIA,mBAAG,CAAA,SAAA,CAAU,MAAM,CAAA;AAC7B,IAAM,MAAA,GAAA,GAAM,MAAM,IAAA,CAAK,IAAK,CAAA,GAAA;AAAA,MAC1B,CAAA,EAAG,KAAK,kBAAmB,CAAA,QAAQ,IAAI,oBAAqB,CAAA,QAAQ,IAAI,CAAC,CAAA;AAAA,KAC3E;AAEA,IAAA,OAAO,GAAI,CAAA,IAAA;AAAA;AAEf","file":"sign-in.js","sourcesContent":["import qs from 'qs';\n\nimport { Client, ClientOptions } from '@microsoft/teams.common/http';\n\nimport { SignInUrlResponse } from '../../models';\nimport { ApiClientSettings, mergeApiClientSettings } from '../api-client-settings';\n\nexport const BOT_SIGNIN_ENDPOINTS = {\n  URL: 'api/botsignin/GetSignInUrl',\n  RESOURCE: 'api/botsignin/GetSignInResource',\n};\n\nexport type GetBotSignInUrlParams = {\n  state: string;\n  codeChallenge?: string;\n  emulatorUrl?: string;\n  finalRedirect?: string;\n};\n\nexport type GetBotSignInResourceParams = {\n  state: string;\n  codeChallenge?: string;\n  emulatorUrl?: string;\n  finalRedirect?: string;\n};\n\nexport class BotSignInClient {\n  get http() {\n    return this._http;\n  }\n  set http(v) {\n    this._http = v;\n  }\n  protected _http: Client;\n  protected _apiClientSettings: Partial<ApiClientSettings>;\n\n  constructor(options?: Client | ClientOptions, apiClientSettings?: Partial<ApiClientSettings>) {\n    if (!options) {\n      this._http = new Client();\n    } else if ('request' in options) {\n      this._http = options;\n    } else {\n      this._http = new Client(options);\n    }\n    this._apiClientSettings = mergeApiClientSettings(apiClientSettings);\n  }\n\n  async getUrl(params: GetBotSignInUrlParams) {\n    const q = qs.stringify(params);\n    const res = await this.http.get<string>(\n      `${this._apiClientSettings.oauthUrl}/${BOT_SIGNIN_ENDPOINTS.URL}?${q}`\n    );\n\n    return res.data;\n  }\n\n  async getResource(params: GetBotSignInResourceParams) {\n    const q = qs.stringify(params);\n    const res = await this.http.get<SignInUrlResponse>(\n      `${this._apiClientSettings.oauthUrl}/${BOT_SIGNIN_ENDPOINTS.RESOURCE}?${q}`\n    );\n\n    return res.data;\n  }\n}\n"]}