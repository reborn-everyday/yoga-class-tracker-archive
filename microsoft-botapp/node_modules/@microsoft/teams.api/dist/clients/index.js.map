{"version":3,"sources":["../../src/clients/index.ts"],"names":["apiClientSettings","http","mergeApiClientSettings","BotClient","UserClient","ConversationClient","TeamClient","MeetingClient"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASO,MAAM,MAAO,CAAA;AAAA,EACT,UAAA;AAAA,EACA,IAAA;AAAA,EACA,KAAA;AAAA,EACA,aAAA;AAAA,EACA,KAAA;AAAA,EACA,QAAA;AAAA,EAET,IAAI,IAAO,GAAA;AACT,IAAA,OAAO,IAAK,CAAA,KAAA;AAAA;AACd,EACA,IAAI,KAAK,CAAG,EAAA;AACV,IAAA,IAAA,CAAK,KAAK,IAAO,GAAA,CAAA;AACjB,IAAA,IAAA,CAAK,cAAc,IAAO,GAAA,CAAA;AAC1B,IAAA,IAAA,CAAK,MAAM,IAAO,GAAA,CAAA;AAClB,IAAA,IAAA,CAAK,MAAM,IAAO,GAAA,CAAA;AAClB,IAAA,IAAA,CAAK,SAAS,IAAO,GAAA,CAAA;AACrB,IAAA,IAAA,CAAK,KAAQ,GAAA,CAAA;AAAA;AACf,EACU,KAAA;AAAA,EACA,kBAAA;AAAA,EAEV,WAAA,CAAY,UAAoB,EAAA,OAAA,EAA4CA,mBAAgD,EAAA;AAC1H,IAAA,IAAA,CAAK,UAAa,GAAA,UAAA;AAElB,IAAA,IAAI,CAAC,OAAS,EAAA;AACZ,MAAK,IAAA,CAAA,KAAA,GAAQ,IAAIC,eAAA,CAAK,MAAO,EAAA;AAAA,KAC/B,MAAA,IAAW,aAAa,OAAS,EAAA;AAC/B,MAAA,IAAA,CAAK,KAAQ,GAAA,OAAA;AAAA,KACR,MAAA;AACL,MAAK,IAAA,CAAA,KAAA,GAAQ,IAAIA,eAAA,CAAK,MAAO,CAAA;AAAA,QAC3B,GAAG,OAAA;AAAA,QACH,OAAS,EAAA;AAAA,UACP,GAAG,OAAS,EAAA,OAAA;AAAA,UACZ,cAAgB,EAAA;AAAA;AAClB,OACD,CAAA;AAAA;AAGH,IAAK,IAAA,CAAA,kBAAA,GAAqBC,yCAAuBF,mBAAiB,CAAA;AAElE,IAAA,IAAA,CAAK,OAAO,IAAIG,aAAA,CAAU,IAAK,CAAA,IAAA,EAAM,KAAK,kBAAkB,CAAA;AAC5D,IAAA,IAAA,CAAK,QAAQ,IAAIC,eAAA,CAAW,IAAK,CAAA,IAAA,EAAM,KAAK,kBAAkB,CAAA;AAC9D,IAAA,IAAA,CAAK,gBAAgB,IAAIC,+BAAA,CAAmB,YAAY,IAAK,CAAA,IAAA,EAAM,KAAK,kBAAkB,CAAA;AAC1F,IAAA,IAAA,CAAK,QAAQ,IAAIC,eAAA,CAAW,YAAY,IAAK,CAAA,IAAA,EAAM,KAAK,kBAAkB,CAAA;AAC1E,IAAA,IAAA,CAAK,WAAW,IAAIC,qBAAA,CAAc,YAAY,IAAK,CAAA,IAAA,EAAM,KAAK,kBAAkB,CAAA;AAAA;AAEpF","file":"index.js","sourcesContent":["import * as http from '@microsoft/teams.common/http';\n\nimport { ApiClientSettings, mergeApiClientSettings } from './api-client-settings';\nimport { BotClient } from './bot';\nimport { ConversationClient } from './conversation';\nimport { MeetingClient } from './meeting';\nimport { TeamClient } from './team';\nimport { UserClient } from './user';\n\nexport class Client {\n  readonly serviceUrl: string;\n  readonly bots: BotClient;\n  readonly users: UserClient;\n  readonly conversations: ConversationClient;\n  readonly teams: TeamClient;\n  readonly meetings: MeetingClient;\n\n  get http() {\n    return this._http;\n  }\n  set http(v) {\n    this.bots.http = v;\n    this.conversations.http = v;\n    this.users.http = v;\n    this.teams.http = v;\n    this.meetings.http = v;\n    this._http = v;\n  }\n  protected _http: http.Client;\n  protected _apiClientSettings: Partial<ApiClientSettings>;\n\n  constructor(serviceUrl: string, options?: http.Client | http.ClientOptions, apiClientSettings?: Partial<ApiClientSettings>) {\n    this.serviceUrl = serviceUrl;\n\n    if (!options) {\n      this._http = new http.Client();\n    } else if ('request' in options) {\n      this._http = options;\n    } else {\n      this._http = new http.Client({\n        ...options,\n        headers: {\n          ...options?.headers,\n          'Content-Type': 'application/json',\n        },\n      });\n    }\n\n    this._apiClientSettings = mergeApiClientSettings(apiClientSettings);\n\n    this.bots = new BotClient(this.http, this._apiClientSettings);\n    this.users = new UserClient(this.http, this._apiClientSettings);\n    this.conversations = new ConversationClient(serviceUrl, this.http, this._apiClientSettings);\n    this.teams = new TeamClient(serviceUrl, this.http, this._apiClientSettings);\n    this.meetings = new MeetingClient(serviceUrl, this.http, this._apiClientSettings);\n  }\n}\n\nexport * from './user';\nexport * from './bot';\nexport * from './conversation';\nexport * from './meeting';\nexport * from './team';\nexport * from './api-client-settings';\n"]}