import*as i from'@microsoft/teams.common/http';import b from'qs';function f(n,t,e){let r={};for(let s of t.query??[])r[s]=e[s];for(let s of t.path??[])n=n.replace(`{${s}}`,e[s]);return `${n}${b.stringify(r,{addQueryPrefix:true,arrayFormat:"comma"})}`}function m(n,t,e){let r=(n.header??[]).reduce((s,o)=>(t[o]&&(s[o]=t[o]),s),{});return Object.keys(r).length===0?e:{...e,headers:{...e?.headers,...r}}}var _="https://graph.microsoft.com",u=class{baseUrlRoot;http;betaHttp;constructor(t){this.baseUrlRoot=t?.baseUrlRoot??_,t?"request"in t?this.http=t.clone({baseUrl:`${this.baseUrlRoot}/v1.0`,headers:{"Content-Type":"application/json","User-Agent":"teams.ts[graph]/2.0.5"}}):this.http=new i.Client({...t,baseUrl:`${this.baseUrlRoot}/v1.0`,headers:{"Content-Type":"application/json","User-Agent":"teams.ts[graph]/2.0.5",...t.headers}}):this.http=new i.Client({baseUrl:`${this.baseUrlRoot}/v1.0`,headers:{"Content-Type":"application/json","User-Agent":"teams.ts[graph]/2.0.5"}});}async call(t,...e){let r=e[e.length-1],s=e.length>t.length&&r&&typeof r=="object"&&"requestConfig"in r,o=s?e.slice(0,-1):e,R=s?r:void 0,{ver:g="v1.0",method:a,path:C,paramDefs:p={},params:h={},body:y}=t(...o),c=f(C,p,h),l=m(p,h,R?.requestConfig),d=this.getHttpClient(g);switch(a){case "delete":case "get":return (await d[a](c,l)).data;case "patch":case "post":case "put":return (await d[a](c,y,l)).data;default:throw new Error(`Unsupported HTTP method: ${a}`)}}getHttpClient(t){return t==="v1.0"?this.http:(this.betaHttp=this.betaHttp??this.http.clone({baseUrl:`${this.baseUrlRoot}/beta`}),this.betaHttp)}};
export{u as Client};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy91dGlscy91cmwudHMiLCIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsiZ2V0SW5qZWN0ZWRVcmwiLCJ1cmwiLCJwYXJhbXMiLCJkYXRhIiwicXVlcnkiLCJwYXJhbSIsInFzIiwiZ2V0SW5qZWN0ZWRSZXF1ZXN0Q29uZmlnIiwicmVxdWVzdENvbmZpZyIsInBhcmFtSGVhZGVycyIsImFnZyIsImRlZmF1bHRCYXNlVXJsUm9vdCIsIkNsaWVudCIsIm9wdGlvbnMiLCJmdW5jIiwiYXJncyIsImxhc3RBcmciLCJoYXNPcHRpb25zIiwiZnVuY0FyZ3MiLCJjYWxsT3B0aW9ucyIsInZlciIsIm1ldGhvZCIsInBhdGgiLCJwYXJhbURlZnMiLCJib2R5IiwiaHR0cENsaWVudCIsInNjaGVtYVZlcnNpb24iXSwibWFwcGluZ3MiOiJpRUFNTyxTQUFTQSxDQUNkQyxDQUFBQSxDQUFBQSxDQUNBQyxDQUNBQyxDQUFBQSxDQUFBQSxDQUNBLENBQ0EsSUFBTUMsQ0FBQUEsQ0FBNkIsRUFFbkMsQ0FBQSxJQUFBLElBQVdDLEtBQVNILENBQU8sQ0FBQSxLQUFBLEVBQVMsRUFBQyxDQUNuQ0UsRUFBTUMsQ0FBSyxDQUFBLENBQUlGLENBQUtFLENBQUFBLENBQUssRUFHM0IsSUFBV0EsSUFBQUEsQ0FBQUEsSUFBU0gsQ0FBTyxDQUFBLElBQUEsRUFBUSxFQUNqQ0QsQ0FBQUEsQ0FBQUEsQ0FBTUEsRUFBSSxPQUFRLENBQUEsQ0FBQSxDQUFBLEVBQUlJLENBQUssQ0FBS0YsQ0FBQUEsQ0FBQUEsQ0FBQUEsQ0FBQUEsQ0FBS0UsQ0FBSyxDQUFDLEVBRzdDLE9BQU8sQ0FBQSxFQUFHSixDQUFHLENBQUEsRUFBR0ssRUFBRyxTQUFVRixDQUFBQSxDQUFBQSxDQUFPLENBQUUsY0FBQSxDQUFnQixLQUFNLFdBQWEsQ0FBQSxPQUFRLENBQUMsQ0FBQyxDQUFBLENBQ3JGLENBRU8sU0FBU0csQ0FBQUEsQ0FDZEwsQ0FDQUMsQ0FBQUEsQ0FBQUEsQ0FDQUssRUFDZ0MsQ0FD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Q0FDSCxRQUFRLE1BQU1JLENBQUFBLENBQVdKLENBQU0sQ0FBQSxDQUFFcEIsRUFBS08sQ0FBYSxDQUFBLEVBQUcsSUFDeEQsQ0FBQSxLQUFLLFFBQ0wsS0FBSyxNQUFBLENBQ0wsS0FBSyxLQUNILENBQUEsT0FBQSxDQUFRLE1BQU1pQixDQUFXSixDQUFBQSxDQUFNLENBQUVwQixDQUFBQSxDQUFBQSxDQUFLdUIsRUFBTWhCLENBQWEsQ0FBQSxFQUFHLElBQzlELENBQUEsUUFDRSxNQUFNLElBQUksS0FBQSxDQUFNLENBQTRCYSx5QkFBQUEsRUFBQUEsQ0FBTSxFQUFFLENBQ3hELENBQ0YsQ0FFUSxhQUFjSyxDQUFBQSxDQUFBQSxDQUEyQyxDQUMvRCxPQUFJQSxDQUFBQSxHQUFrQixNQUNiLENBQUEsSUFBQSxDQUFLLE1BR2QsSUFBSyxDQUFBLFFBQUEsQ0FDSCxLQUFLLFFBQ0wsRUFBQSxJQUFBLENBQUssS0FBSyxLQUFNLENBQUEsQ0FDZCxPQUFTLENBQUEsQ0FBQSxFQUFHLEtBQUssV0FBVyxDQUFBLEtBQUEsQ0FDOUIsQ0FBQyxDQUVJLENBQUEsSUFBQSxDQUFLLFNBQ2QsQ0FDRiIsImZpbGUiOiJpbmRleC5tanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcXMgZnJvbSAncXMnO1xuXG5pbXBvcnQgKiBhcyBodHRwIGZyb20gJ0BtaWNyb3NvZnQvdGVhbXMuY29tbW9uL2h0dHAnO1xuXG5pbXBvcnQgeyBQYXJhbURlZnMgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRJbmplY3RlZFVybChcbiAgdXJsOiBzdHJpbmcsXG4gIHBhcmFtczogUGFyYW1EZWZzLFxuICBkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuKSB7XG4gIGNvbnN0IHF1ZXJ5OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG5cbiAgZm9yIChjb25zdCBwYXJhbSBvZiBwYXJhbXMucXVlcnkgPz8gW10pIHtcbiAgICBxdWVyeVtwYXJhbV0gPSBkYXRhW3BhcmFtXTtcbiAgfVxuXG4gIGZvciAoY29uc3QgcGFyYW0gb2YgcGFyYW1zLnBhdGggPz8gW10pIHtcbiAgICB1cmwgPSB1cmwucmVwbGFjZShgeyR7cGFyYW19fWAsIGRhdGFbcGFyYW1dKTtcbiAgfVxuXG4gIHJldHVybiBgJHt1cmx9JHtxcy5zdHJpbmdpZnkocXVlcnksIHsgYWRkUXVlcnlQcmVmaXg6IHRydWUsIGFycmF5Rm9ybWF0OiAnY29tbWEnIH0pfWA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRJbmplY3RlZFJlcXVlc3RDb25maWcoXG4gIHBhcmFtczogUGFyYW1EZWZzLFxuICBkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuICByZXF1ZXN0Q29uZmlnPzogaHR0cC5SZXF1ZXN0Q29uZmlnLFxuKTogaHR0cC5SZXF1ZXN0Q29uZmlnIHwgdW5kZWZpbmVkIHtcbiAgY29uc3QgcGFyYW1IZWFkZXJzID0gKHBhcmFtcy5oZWFkZXIgPz8gW10pLnJlZHVjZTxSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgICAoYWdnLCBwYXJhbSkgPT4ge1xuICAgICAgaWYgKGRhdGFbcGFyYW1dKSB7XG4gICAgICAgIGFnZ1twYXJhbV0gPSBkYXRhW3BhcmFtXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhZ2c7XG4gICAgfSxcbiAgICB7fSxcbiAgKTtcblxuICByZXR1cm4gT2JqZWN0LmtleXMocGFyYW1IZWFkZXJzKS5sZW5ndGggPT09IDBcbiAgICA/IHJlcXVlc3RDb25maWdcbiAgICA6IHtcbiAgICAgICAgLi4ucmVxdWVzdENvbmZpZyxcbiAgICAgICAgaGVhZGVyczogeyAuLi5yZXF1ZXN0Q29uZmlnPy5oZWFkZXJzLCAuLi5wYXJhbUhlYWRlcnMgfSxcbiAgICAgIH07XG59XG4iLCJpbXBvcnQgKiBhcyBodHRwIGZyb20gJ0BtaWNyb3NvZnQvdGVhbXMuY29tbW9uL2h0dHAnO1xuXG5pbXBvcnQgeyBnZXRJbmplY3RlZFVybCwgZ2V0SW5qZWN0ZWRSZXF1ZXN0Q29uZmlnIH0gZnJvbSAnLi91dGlscy91cmwnO1xuXG5pbXBvcnQgdHlwZSB7IENhbGxPcHRpb25zLCBFbmRwb2ludFJlcXVlc3QsIFNjaGVtYVZlcnNpb24gfSBmcm9tICcuL3R5cGVzJztcblxuLy8gQnVpbGQtdGltZSBjb25zdGFudCBpbmplY3RlZCBieSB0c3VwXG5kZWNsYXJlIGNvbnN0IF9fUEFDS0FHRV9WRVJTSU9OX186IHN0cmluZztcblxuZXhwb3J0IHsgQ2FsbE9wdGlvbnMsIEVuZHBvaW50UmVxdWVzdCwgU2NoZW1hVmVyc2lvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5jb25zdCBkZWZhdWx0QmFzZVVybFJvb3QgPSAnaHR0cHM6Ly9ncmFwaC5taWNyb3NvZnQuY29tJztcblxudHlwZSBPcHRpb25zID0gKGh0dHAuQ2xpZW50IHwgaHR0cC5DbGllbnRPcHRpb25zKSAmIHtcbiAgLyoqIEdyYXBoIHNlcnZpY2Ugcm9vdC4gQnkgZGVmYXVsdCwgdGhlIGdsb2JhbCBjb21tZXJjaWFsIFVSTCBcImh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbVwiIGlzIHVzZWQsXG4gICAqIGJ1dCBjZXJ0YWluIHRlbmFudHMgbWF5IHdpc2ggdG8gb3ZlcnJpZGUgdGhpcyB0byBkaXJlY3QgR3JhcGggQVBJIGNhbGxzIHRvIGEgZGlmZmVyZW50IGNsb3VkIGluc3RhbmNlLlxuICAgKi9cbiAgYmFzZVVybFJvb3Q/OiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIC9cbiAqIFByb3ZpZGVzIGFuIGVudHJ5IHBvaW50IGZvciBpbnZva2luZyBNaWNyb3NvZnQgR3JhcGggQVBJcy5cbiAqL1xuZXhwb3J0IGNsYXNzIENsaWVudCB7XG4gIHByb3RlY3RlZCBiYXNlVXJsUm9vdDtcbiAgcHJvdGVjdGVkIGh0dHA6IGh0dHAuQ2xpZW50O1xuICBwcm90ZWN0ZWQgYmV0YUh0dHA/OiBodHRwLkNsaWVudDtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zPzogT3B0aW9ucykge1xuICAgIHRoaXMuYmFzZVVybFJvb3QgPSBvcHRpb25zPy5iYXNlVXJsUm9vdCA/PyBkZWZhdWx0QmFzZVVybFJvb3Q7XG4gICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICB0aGlzLmh0dHAgPSBuZXcgaHR0cC5DbGllbnQoe1xuICAgICAgICBiYXNlVXJsOiBgJHt0aGlzLmJhc2VVcmxSb290fS92MS4wYCxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ1VzZXItQWdlbnQnOiBgdGVhbXMudHNbZ3JhcGhdLyR7X19QQUNLQUdFX1ZFUlNJT05fX31gLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICgncmVxdWVzdCcgaW4gb3B0aW9ucykge1xuICAgICAgdGhpcy5odHRwID0gb3B0aW9ucy5jbG9uZSh7XG4gICAgICAgIGJhc2VVcmw6IGAke3RoaXMuYmFzZVVybFJvb3R9L3YxLjBgLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAnVXNlci1BZ2VudCc6IGB0ZWFtcy50c1tncmFwaF0vJHtfX1BBQ0tBR0VfVkVSU0lPTl9ffWAsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5odHRwID0gbmV3IGh0dHAuQ2xpZW50KHtcbiAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgYmFzZVVybDogYCR7dGhpcy5iYXNlVXJsUm9vdH0vdjEuMGAsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdVc2VyLUFnZW50JzogYHRlYW1zLnRzW2dyYXBoXS8ke19fUEFDS0FHRV9WRVJTSU9OX199YCxcbiAgICAgICAgICAuLi5vcHRpb25zLmhlYWRlcnMsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZXMgYSBHcmFwaCBBUEkgZW5kcG9pbnQgZnVuY3Rpb24gd2l0aCBvcHRpb25hbCBIVFRQIGNvbmZpZ3VyYXRpb25cbiAgICpcbiAgICogQHBhcmFtIGZ1bmMgLSBUaGUgZW5kcG9pbnQgZnVuY3Rpb24gdG8gZXhlY3V0ZVxuICAgKiBAcGFyYW0gYXJncyAtIEFyZ3VtZW50cyBmb3IgdGhlIGVuZHBvaW50IGZ1bmN0aW9uLCBvcHRpb25hbGx5IGZvbGxvd2VkIGJ5IHtAbGluayBDYWxsQ29uZmlnfVxuICAgKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB0byB0aGUgZW5kcG9pbnQncyByZXNwb25zZSBkYXRhXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogLy8gU2ltcGxlIGNhbGxcbiAgICogY29uc3QgdXNlciA9IGF3YWl0IGNsaWVudC5jYWxsKGVuZHBvaW50cy51c2Vycy5nZXQsICd1c2VyLWlkJyk7XG4gICAqXG4gICAqIC8vIFdpdGggSFRUUCBjb25maWd1cmF0aW9uXG4gICAqIGNvbnN0IHVzZXIgPSBhd2FpdCBjbGllbnQuY2FsbChlbmRwb2ludHMudXNlcnMuZ2V0LCAndXNlci1pZCcsIHtcbiAgICogICByZXF1ZXN0Q29uZmlnOiB7XG4gICAqICAgICB0aW1lb3V0OiA1MDAwXG4gICAqICAgfVxuICAgKiB9KTtcbiAgICogYGBgXG4gICAqL1xuICBhc3luYyBjYWxsPFxuICAgIEYgZXh0ZW5kcyAoLi4uYXJnczogYW55W10pID0+IEVuZHBvaW50UmVxdWVzdDxhbnk+LFxuICAgIFIgPSBSZXR1cm5UeXBlPEY+IGV4dGVuZHMgRW5kcG9pbnRSZXF1ZXN0PGluZmVyIFQ+ID8gVCA6IG5ldmVyLFxuICA+KGZ1bmM6IEYsIC4uLmFyZ3M6IFsuLi5QYXJhbWV0ZXJzPEY+LCBDYWxsT3B0aW9ucz9dKTogUHJvbWlzZTxSPiB7XG4gICAgLy8gQ2hlY2sgaWYgbGFzdCBhcmcgaXMgYSBjb25maWcgb2JqZWN0XG4gICAgY29uc3QgbGFzdEFyZyA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcbiAgICBjb25zdCBoYXNPcHRpb25zID1cbiAgICAgIGFyZ3MubGVuZ3RoID4gZnVuYy5sZW5ndGggJiZcbiAgICAgIGxhc3RBcmcgJiZcbiAgICAgIHR5cGVvZiBsYXN0QXJnID09PSAnb2JqZWN0JyAmJlxuICAgICAgJ3JlcXVlc3RDb25maWcnIGluIGxhc3RBcmc7XG5cbiAgICAvLyBFeHRyYWN0IGZ1bmN0aW9uIGFyZ3VtZW50c1xuICAgIGNvbnN0IGZ1bmNBcmdzID0gaGFzT3B0aW9ucyA/IGFyZ3Muc2xpY2UoMCwgLTEpIDogYXJncztcbiAgICBjb25zdCBjYWxsT3B0aW9ucyA9IGhhc09wdGlvbnMgPyBsYXN0QXJnIGFzIENhbGxPcHRpb25zIDogdW5kZWZpbmVkO1xuXG4gICAgY29uc3Qge1xuICAgICAgdmVyID0gJ3YxLjAnLFxuICAgICAgbWV0aG9kLFxuICAgICAgcGF0aCxcbiAgICAgIHBhcmFtRGVmcyA9IHt9LFxuICAgICAgcGFyYW1zID0ge30sXG4gICAgICBib2R5LFxuICAgIH0gPSBmdW5jKC4uLihmdW5jQXJncyBhcyBhbnlbXSkpO1xuICAgIGNvbnN0IHVybCA9IGdldEluamVjdGVkVXJsKHBhdGgsIHBhcmFtRGVmcywgcGFyYW1zKTtcbiAgICBjb25zdCByZXF1ZXN0Q29uZmlnID0gZ2V0SW5qZWN0ZWRSZXF1ZXN0Q29uZmlnKHBhcmFtRGVmcywgcGFyYW1zLCBjYWxsT3B0aW9ucz8ucmVxdWVzdENvbmZpZyk7XG4gICAgY29uc3QgaHR0cENsaWVudCA9IHRoaXMuZ2V0SHR0cENsaWVudCh2ZXIpO1xuXG4gICAgc3dpdGNoIChtZXRob2QpIHtcbiAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICBjYXNlICdnZXQnOlxuICAgICAgICByZXR1cm4gKGF3YWl0IGh0dHBDbGllbnRbbWV0aG9kXSh1cmwsIHJlcXVlc3RDb25maWcpKS5kYXRhIGFzIFI7XG4gICAgICBjYXNlICdwYXRjaCc6XG4gICAgICBjYXNlICdwb3N0JzpcbiAgICAgIGNhc2UgJ3B1dCc6XG4gICAgICAgIHJldHVybiAoYXdhaXQgaHR0cENsaWVudFttZXRob2RdKHVybCwgYm9keSwgcmVxdWVzdENvbmZpZykpLmRhdGEgYXMgUjtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgSFRUUCBtZXRob2Q6ICR7bWV0aG9kfWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0SHR0cENsaWVudChzY2hlbWFWZXJzaW9uOiBTY2hlbWFWZXJzaW9uKTogaHR0cC5DbGllbnQge1xuICAgIGlmIChzY2hlbWFWZXJzaW9uID09PSAndjEuMCcpIHtcbiAgICAgIHJldHVybiB0aGlzLmh0dHA7XG4gICAgfVxuXG4gICAgdGhpcy5iZXRhSHR0cCA9XG4gICAgICB0aGlzLmJldGFIdHRwID8/XG4gICAgICB0aGlzLmh0dHAuY2xvbmUoe1xuICAgICAgICBiYXNlVXJsOiBgJHt0aGlzLmJhc2VVcmxSb290fS9iZXRhYCxcbiAgICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMuYmV0YUh0dHA7XG4gIH1cbn1cbiJdfQ==